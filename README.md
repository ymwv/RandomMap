# RandomMap
游戏地图是许多游戏不可或缺的一部分，而能够自我变化的游戏地图则更丰富了游戏的内容，例如《挺进地牢》、《以撒的结合》、《死亡细胞》等游戏都采用了随机地图这一机制，给游戏带来丰富多样的变化,也使得游戏延长了寿命。

我自己很喜欢玩，并且之后也打算制作一款利用这种机制的游戏，所以我这次就尝试用Unity制作一下生成地图的这个功能。
![思路](http://img.mcatin.com/202008031ERP3XOMPKE56R5ZB4UMNTZ.png)
1. 首先随机在地图上创建一些房间
2. 然后将他们重叠的部分进行移动并调整到合适的位置
3. 筛选出符合条件的房间，然后以每个房间的中心点为结点进行三角剖分运算后，生成最小生成树以确定连通关系
4. 最后将路径转换成曼哈顿距离的路径来完成道路的样貌。
##实现

新建并打开工程之后，我们先将需要的资源导入到工程中。除了美术资源以外，我还用到了Delaunay脚本，用于保存表达房间之间连接关系的最小生成树。而RandomFromDistribution脚本中提供了用于计算房间大小的随机分布算法，让生成房间的大小保证在一定的范围内。

导入这些资源后，就可以正式开始制作了。

 

在这我为了能够标记并描述一个房间，记录了如下的内容：

1. 房间中心点的位置（position）
2. 房间的尺寸（size）
3. 房间的类型（type）
同时为了能够简单的检测碰撞，还额外记录了矩形在X轴和Y轴上最大和最小的坐标，这样只要通过简单的比较，就可以判断两个房间是否重叠。

## 参考
[unitu随机地图上传](http://www.mcatin.com/#/article?id=202008031EWW1EU54AJFY0KOTTI60X8)
